let orderId,localStorageContent=localStorage.getItem("cart"),cartItemsArray=JSON.parse(localStorageContent);function addNumCart(){if(localStorageContent){document.querySelector(".cartItemsTotal").innerHTML=cartItemsArray.length}}function displayCart(){let e=localStorage.getItem("cart"),t=JSON.parse(e);if(t)for(let e=0;e<t.length;e++){let a=document.getElementById("shoppingCart"),l=document.createElement("li");l.classList.add("cart-row","list-group-item","d-flex","justify-content-between","lh-sm"),l.style.height="75px";let o=document.createElement("div");o.classList.add("w-50"),o.innerHTML='<p class="my-0">'+t[e].name+'</p> <small class="text-muted">'+t[e].selectColors+"</small>";let n=document.createElement("div");n.classList.add("w-25"),n.style.marginTop="12px",n.innerHTML='<p class="cart-price text-bold">$'+t[e].price/100+"</p>";let r=document.createElement("button");r.setAttribute("type","button"),r.classList.add("btn","my-2","py-1","px-2","remove"),r.setAttribute("aria-label","remove"),r.innerHTML='<i class="bi bi-dash-square"></i>',r.onclick=function(){let t=JSON.parse(localStorage.getItem("cart"));t.splice(e,1),localStorage.setItem("cart",JSON.stringify(t)),location.reload()},a.appendChild(l),l.appendChild(o),l.appendChild(n),l.appendChild(r)}}function updateCartTotal(){let e=document.getElementById("totalCost"),t=0;for(let e=0;e<cartItemsArray.length;e++)t+=cartItemsArray[e].price/100;e.innerHTML="$"+t,sessionStorage.setItem("price",t)}function makeRequest(e){fetch("https://orinoco-ncsr.onrender.com/api/teddies/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){orderId=e.orderId,sessionStorage.setItem("orderId",orderId),console.log(orderId),location.replace("confirmation.html")}).catch(function(e){console.log(e)})}addNumCart(),function(){var e=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(e).forEach(function(e){e.addEventListener("submit",function(t){if(e.checkValidity()){t.preventDefault(),t.stopPropagation(),console.log("true");let e=[],a=JSON.parse(localStorage.getItem("cart"));for(let t=0;t<a.length;t++)e.push(a[t].id);let l=document.getElementById("firstName"),o=document.getElementById("lastName"),n=document.getElementById("email"),r=document.getElementById("address"),s=document.getElementById("country"),c=document.getElementById("city"),d=document.getElementById("zip"),i={firstName:l.value,lastName:o.value,email:n.value,address:r.value,country:s.value,city:c.value,zip:d.value};makeRequest({contact:i,products:e}),sessionStorage.setItem("firstName",i.firstName)}else t.preventDefault(),t.stopPropagation(),console.log("not valid");e.classList.add("was-validated")},!1)})}(),displayCart(),updateCartTotal();